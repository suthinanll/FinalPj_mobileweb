<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, query, onSnapshot, doc, deleteDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // Firebase config
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "project-finalmbw.firebaseapp.com",
            projectId: "project-finalmbw",
            storageBucket: "project-finalmbw.firebasestorage.app",
            messagingSenderId: "742173296191",
            appId: "1:742173296191:web:91474e78e2c39275725a8a",
            measurementId: "G-MNXL2CMT5S"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // ‡πÉ‡∏ä‡πâ CID ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏•‡∏≤‡∏™
        const cid = "YOUR_CID";

        document.addEventListener("DOMContentLoaded", () => {
            const studentTable = document.getElementById("studentTable");

            // ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏à‡∏≤‡∏Å Firestore
            const q = query(collection(db, `classroom/${cid}/students`));
            onSnapshot(q, (snapshot) => {
                studentTable.innerHTML = "";
                let index = 1;
                snapshot.forEach((doc) => {
                    const student = doc.data();
                    const row = `
                        <tr>
                            <td>${index++}</td>
                            <td>${student.studentId}</td>
                            <td>${student.name}</td>
                            <td><img src="${student.photoUrl || 'https://via.placeholder.com/50'}" alt="profile" width="50" height="50" class="rounded-circle"></td>
                            <td>${student.status ? "‚úî ‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô" : "‚ùå ‡πÑ‡∏°‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô"}</td>
                            <td>
                                <button class="btn btn-danger btn-sm" onclick="deleteStudent('${doc.id}')">üóë ‡∏•‡∏ö</button>
                            </td>
                        </tr>
                    `;
                    studentTable.innerHTML += row;
                });
            });
        });

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏•‡∏ö‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤
        window.deleteStudent = async (studentId) => {
            if (confirm("‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏µ‡πâ?")) {
                await deleteDoc(doc(db, `classroom/${cid}/students`, studentId));
                alert("‡∏•‡∏ö‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!");
            }
        };
    </script>
</head>
<body>
    <div class="container mt-5">
        <h2 class="text-center">üìú ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤</h2>
        <table class="table table-bordered">
            <thead class="table-dark">
                <tr>
                    <th>‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
                    <th>‡∏£‡∏´‡∏±‡∏™</th>
                    <th>‡∏ä‡∏∑‡πà‡∏≠</th>
                    <th>‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û</th>
                    <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                    <th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                </tr>
            </thead>
            <tbody id="studentTable">
                <tr>
                    <td colspan="6" class="text-center">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</td>
                </tr>
            </tbody>
        </table>
    </div>
</body>
</html>
